# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/pyrate_info/pyrate_mcmc_logs/rats_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/pyrate_info/pyrate_mcmc_logs/rats_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.118068452274, 0.118068452274,0.13215139741,0.13215139741,0.13215139741,0.13215139741,0.133022339129,0.13215139741,0.133022339129,0.133022339129,0.133022339129,0.133022339129,0.133022339129,0.13215139741,0.133003096901,0.13215139741,0.133003096901,0.133003096901,0.133003096901,0.133003096901,0.133003096901,0.133003096901,0.133003096901,0.133003096901,0.136591449409,0.136591449409,0.136591449409,0.133851894031,0.133003096901,0.133851894031,0.133003096901,0.133851894031)
L_hpd_M95=c(0.215498701631, 0.215498701631,0.215498701631,0.215498701631,0.215498701631,0.215498701631,0.215498701631,0.214766060325,0.214766060325,0.214766060325,0.214766060325,0.214766060325,0.214766060325,0.212340472513,0.212340472513,0.207405690514,0.207405690514,0.207405690514,0.207405690514,0.207405690514,0.206775848944,0.207405690514,0.207405690514,0.207405690514,0.21418060118,0.21418060118,0.21418060118,0.212919810426,0.212919810426,0.214766060325,0.218419421369,0.262431122287)
M_hpd_m95=c(0.652383950453, 0.652383950453,0.137053620557,0.137053620557,0.139433026457,0.139433026457,0.139433026457,0.139433026457,0.139433026457,0.139433026457,0.142540641619,0.146987946189,0.146987946189,0.146987946189,0.146987946189,0.0402211962205,0.0310369157092,0.0282705475807,0.0282705475807,0.0286903249338,0.0286903249338,0.0282705475807,0.0282705475807,0.0282705475807,0.0282705475807,0.0272016075024,0.0272016075024,0.0272016075024,0.0272016075024,0.0272016075024,0.0272016075024,0.0272016075024)
M_hpd_M95=c(1.89077752287, 1.89077752287,0.264830763674,0.250617176467,0.250617176467,0.250617176467,0.250617176467,0.250617176467,0.250617176467,0.250617176467,0.253337465836,0.253337465836,0.253337465836,0.253337465836,0.253337465836,0.253337465836,0.199837783489,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0869681535302,0.0880230824019,0.0880230824019)
R_hpd_m95=c(-1.73713351536, -1.73713351536,-0.0924251814497,-0.0885293648986,-0.0979008527855,-0.0979008527855,-0.100628174534,-0.0979008527855,-0.0979008527855,-0.0979008527855,-0.0979008527855,-0.0979008527855,-0.0979008527855,-0.0979008527855,-0.0979008527855,-0.0843868368311,-0.0210210948164,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0724008299997,0.0609424021891,0.0609424021891,0.0590512066749,0.0590512066749)
R_hpd_M95=c(-0.494743412291, -0.494743412291,0.05934431036,0.0578724044833,0.0413903650313,0.0413903650313,0.0413903650313,0.0368228047072,0.0368228047072,0.0368228047072,0.0375485709209,0.0368228047072,0.0368228047072,0.0368228047072,0.0368228047072,0.138862452136,0.1630145469,0.161431230005,0.161431230005,0.161431230005,0.161431230005,0.1630145469,0.1630145469,0.1630145469,0.164395797211,0.164395797211,0.164395797211,0.170130691982,0.1630145469,0.164395797211,0.170130691982,0.225018695383)
L_mean=c(0.177167961983, 0.177167961983,0.174620025844,0.174620025844,0.174620025844,0.174620025844,0.174130106655,0.170839982462,0.169978506028,0.169778958576,0.169931374913,0.169724332676,0.169549424302,0.169686157789,0.169848270269,0.171162454956,0.17127325481,0.171638740713,0.171766738995,0.172325664834,0.172302676051,0.172363303664,0.172318988248,0.172304070269,0.1728314125,0.172803142602,0.172521888062,0.173586194777,0.173832769749,0.174524442045,0.177050317626,0.186109522817)
M_mean=c(1.30555529681, 1.30555529681,0.201442977253,0.2000792917,0.199812573192,0.199812573192,0.199863933004,0.199863933004,0.199863933004,0.200645284242,0.201458155809,0.202931833832,0.203371679084,0.203371679084,0.203371679084,0.178322764654,0.0701179683574,0.0588978023368,0.0588978023368,0.0588121437658,0.0587808535979,0.0589994922662,0.0589994922662,0.0589994922662,0.0589994922662,0.0584733010636,0.0584733010636,0.0584733010636,0.0585335307317,0.0586044748346,0.0582687804936,0.0582608385729)
R_mean=c(-1.12838733483, -1.12838733483,-0.0268229514086,-0.0254592658561,-0.0251925473476,-0.0251925473476,-0.0257338263485,-0.0290239505413,-0.0298854269753,-0.0308663256661,-0.0315267808952,-0.0332075011558,-0.0338222547818,-0.0336855212952,-0.0335234088152,-0.00716030969858,0.101155286453,0.112740938376,0.112868936659,0.113513521068,0.113521822454,0.113363811398,0.113319495982,0.113304578003,0.113831920234,0.114329841539,0.114048586999,0.115112893713,0.115299239018,0.11591996721,0.118781537133,0.127848684244)
trans=0.5
age=(0:(32-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.288674234515), xlim = c(-33.6,1.6), ylab = 'Speciation rate', xlab = 'Ma',main='rats' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 2.07985527516), xlim = c(-33.6,1.6), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.91084686689, 0.247520564921), xlim = c(-33.6,1.6), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-33.6,1.6), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()